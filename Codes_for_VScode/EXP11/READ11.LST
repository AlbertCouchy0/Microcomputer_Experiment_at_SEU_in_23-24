 The Microsoft MACRO Assembler , Version 1.27          	Page	1-1
	 	 	 	 	 	 	 	05-15-<4    


 0000	 	 	 	DATA SEGMENT
 	 	 	 	 	;æç¤ºæ¶ˆæ¯
 0000  ?? ?? 2D 4D 41 4B	 	MSG1    DB 	?,?,'-MAKA BAKA';å­—ç¬¦
	 	 	 	ä¸²1
       41 20 42 41 4B 41	
 = 000C	 	 	 	 	SLENGTH1 EQU 	$-MSG1
 000C  ?? ?? 2D 57 55 58	 	MSG2    DB 	?,?,'-WUXI DIXI';å­—ç¬¦
	 	 	 	ä¸²2
       49 20 44 49 58 49	
 = 000C	 	 	 	 	SLENGTH2 EQU	$-MSG2
 	 	 	 	 	;è®¡æ•°å™¨
 0018  00	 	 	 	COUNT   DB 0        
 0019  00	 	 	 	CLOCK   DB 0	
 001A  00	 	 	 	KEYN    DB 0
 	 	 	 	 	;è®¡æ•°ä¸Šé™
 = 000C	 	 	 	 	LIM1 	EQU 12D	 	;é”®ç›˜ä¸­æ–­è®
	 	 	 	¡æ•°ä¸Šé™
 = 000C	 	 	 	 	LIM2 	EQU 12D	 	;å®šæ—¶ä¸­æ–­è®
	 	 	 	¡æ•°ä¸Šé™
 001B  19	 	 	 	LINE    DB 25       ;æœ€å¤§æ˜¾ç¤ºè¡Œæ•°
 	 	 	 	    ;è¾“å…¥æ—¶é—´å¹¶æ£€éªŒ
 001C  03	 	 	    TIME 	DB  3       ;ç¼“å†²åŒº
 001D  ??	 	 	 	        DB  ?;
 001E     03 [	 	 	            DB 3  DUP(?);	
                ??	 	
                    ]	 	
 	 	 	 	
 0021  0A	 	 	    T       DB 10       ;è¾“å…¥æ—¶é—´çš„æ•°å€¼
 0022  12	 	 	 	N 	 	DB 18       ;è½¬æ¢ä¸ºè
	 	 	 	®¡æ•°æ¬¡æ•°
 0023  50 6C 65 61 73 65	    TXT1    DB "Please input TIME in units of 0
	 	 	 	.1s(5<=TIME<=50):$"  ;æ–‡æœ¬æç¤º1
       20 69 6E 70 75 74	
       20 54 49 4D 45 20	
       69 6E 20 75 6E 69	
       74 73 20 6F 66 20	
       30 2E 31 73 28 35	
       3C 3D 54 49 4D 45	
       3C 3D 35 30 29 3A	
       24	 	 	
 0054  0D 0A 57 72 6F 6E	    ERROR0  DB 0DH,0AH,'Wrong Input Format!',0A
	 	 	 	H,'$'                ;é”™è¯¯æç¤º0
       67 20 49 6E 70 75	
       74 20 46 6F 72 6D	
       61 74 21 0A 24	 	
 006B  0D 0A 54 68 65 20	    ERROR1  DB 0DH,0AH,'The Input is too small!
	 	 	 	',0AH,'$'            ;é”™è¯¯æç¤º1       
       49 6E 70 75 74 20	
       69 73 20 74 6F 6F	
       20 73 6D 61 6C 6C	
       21 0A 24	 	 	
 0086  0D 0A 54 68 65 20	    ERROR2  DB 0DH,0AH,'The Input is too big!',
	 	 	 	0AH,'$'              ;é”™è¯¯æç¤º2     
 The Microsoft MACRO Assembler , Version 1.27          	Page	1-2
	 	 	 	 	 	 	 	05-15-<4    


       49 6E 70 75 74 20	
       69 73 20 74 6F 6F	
       20 62 69 67 21 0A	
       24	 	 	
 009F	 	 	 	DATA ENDS
 	 	 	 	
 0000	 	 	 	STACK SEGMENT STACK
 0000  0300 [	 	 	 	DW 300H DUP(?)
                ????	 	
                      ]	 	
 	 	 	 	
 0600	 	 	 	STACK ENDS
 	 	 	 	
 0000	 	 	 	CODE SEGMENT
 	 	 	 	 	ASSUME CS:CODE,SS:STACK,DS:DATA
 0000	 	 	 	START:
 	 	 	 	;ç»™æ®µå¯„å­˜å™¨èµ‹å€¼
 0000  B8 ---- R	 	 	MOV AX,STACK
 0003  8E D0	 	 	 	MOV SS,AX
 0005  B8 ---- R	 	 	MOV AX,DATA
 0008  8E D8	 	 	 	MOV DS,AX
 000A  B8 0000	 	 	 	MOV AX,0
 000D  8E C0	 	 	 	MOV ES,AX	
 	 	 	 	;è¾“å‡ºæç¤ºæ–‡æœ¬
 000F  8D 36 0023 R	 	    LEA SI,TXT1         ;å–TXT1åœ°å€
 0013  8B D6	 	 	    MOV DX,SI           ;èµ‹å€¼åœ°å€ç»™DX
 0015  B4 09	 	 	    MOV AH,09	 	 	;åŠŸèƒ½å·09H
 0017  CD 21	 	 	    INT 21H    	 	 	;ç±»åž‹å·21Hï¼
	 	 	 	Œæ˜¾ç¤ºDSï¼šDXæŒ‡å‘çš„ä»¥$ç»“å°¾çš„å­—ç¬¦ä¸²
 	 	 	 	;è¾“å…¥TIME
 0019  8D 36 001C R	 	    LEA SI,TIME;
 001D  8B D6	 	 	    MOV DX,SI           ;èµ‹å€¼åœ°å€ç»™DX
 001F  B4 0A	 	 	    MOV  AH, 0AH;	
 0021  CD 21	 	 	 	INT  21H            ;è¾“å…¥
 	 	 	 	;æ£€éªŒ
 0023  E8 00BB R	 	    CALL  INPUTerror    ;åˆ¤æ–­è¾“å…¥æ ¼å¼æ˜¯å
	 	 	 	¦é”™è¯¯
 0026  E8 00E7 R	 	    CALL  ASCtoNUM      ;æŠŠç¼“å­˜åŒºASCIIç è½
	 	 	 	¬æ¢æˆNUM
 0029  E8 0108 R	 	 	CALL  VALUEerror    ;åˆ¤æ–­æ—¶é—´æ˜¯å¦
	 	 	 	åœ¨èŒƒå›´å†…	
 	 	 	 	;å°†æ—¶é—´è½¬æ¢ä¸ºè®¡æ•°æ¬¡æ•°å‚¨å­˜
 002C  56	 	 	        PUSH SI
 002D  50	 	 	        PUSH AX
 002E  53	 	 	        PUSH BX
 	 	 	 	
 002F  8D 36 0021 R	 	 	    LEA SI,T        ;å–Té¦–åœ°å€
 0033  2B C0	 	 	        SUB AX,AX;
 0035  8A 04	 	 	 	    MOV AL,[SI];
 0037  B3 64	 	 	 	    MOV BL,100D
 0039  F6 E3	 	 	 	    MUL BL;
 003B  B3 37	 	 	 	    MOV BL,55D
 003D  F6 F3	 	 	 	    DIV BL;
 The Microsoft MACRO Assembler , Version 1.27          	Page	1-3
	 	 	 	 	 	 	 	05-15-<4    


 003F  8D 36 0022 R	 	 	    LEA SI,N        ;å–Né¦–åœ°å€
 0043  88 04	 	 	 	    MOV [SI],AL
 	 	 	 	
 0045  5B	 	 	        POP BX
 0046  58	 	 	        POP AX
 0047  5E	 	 	 	    POP SI
 	 	 	 	;æ¸…ç©ºå„å¯„å­˜å™¨
 0048  2B C0	 	 	    SUB AX,AX;
 004A  2B DB	 	 	    SUB BX,BX;
 004C  2B C9	 	 	    SUB CX,CX;
 004E  2B D2	 	 	    SUB DX,DX;
 0050  2B F6	 	 	    SUB SI,SI;
 0052  2B FF	 	 	    SUB DI,DI;
 	 	 	 	;ä¿å­˜åŽŸ1CHä¸­æ–­å‘é‡
 0054  26: A1 0070	 	 	MOV AX,ES:[1CH*4]
 0058  50	 	 	 	PUSH AX
 0059  26: A1 0072	 	 	MOV AX,ES:[1CH*4+2]
 005D  50	 	 	 	PUSH AX
 	 	 	 	;ç½®1CHä¸­æ–­å‘é‡
 005E  FA	 	 	 	CLI
 005F  B8 022B R	 	 	MOV AX,OFFSET TIMERINTS
 0062  26: A3 0070	 	 	MOV ES:[1CH*4],AX
 0066  B8 ---- R	 	 	MOV AX,SEG TIMERINTS
 0069  26: A3 0072	 	 	MOV ES:[1CH*4+2],AX
 006D  FB	 	 	 	STI
 	 	 	 	;ä¿å­˜åŽŸ09Hçš„ä¸­æ–­
 006E  26: A1 0024	 	 	MOV AX,ES:[09H*4]
 0072  50	 	 	 	PUSH AX
 0073  26: A1 0026	 	 	MOV AX,ES:[09H*4+2]
 0077  50	 	 	 	PUSH AX
 0078  1E	 	 	 	PUSH DS
 	 	 	 	;ç½®09Hä¸­æ–­å‘é‡
 0079  FA	 	 	 	CLI
 007A  B8 ---- R	 	 	MOV	AX, SEG KEYINT
 007D  8E D8	 	 	 	MOV	DS, AX
 007F  BA 0252 R	 	 	MOV	DX, OFFSET KEYINT
 0082  B0 09	 	 	 	MOV	AL, 09H	 	 	
 	 	 	 	 	
 0084  B4 25	 	 	 	MOV	AH, 25H
 0086  CD 21	 	 	 	INT	21H
 0088  FB	 	 	 	STI
 	 	 	 	
 0089  1F	 	 	 	POP DS;
 	 	 	 	;è°ƒç”¨DISP1æ˜¾ç¤ºå¤ªé˜³
 008A	 	 	 	AGAIN:
 008A  9A 012A ---- R	 	 	CALL FAR PTR DISP1
 008F  80 3E 001A R 0C	 	 	CMP KEYN,LIM1       ;ä¸ŽLIM1æ¯”è¾ƒ
 0094  73 09	 	 	 	JAE NEXT
 0096  80 3E 0019 R 0C	 	 	CMP CLOCK,LIM2      ;ä¸ŽLIM2æ¯”è¾ƒ
 009B  73 02	 	 	 	JAE NEXT
 009D  EB EB	 	 	 	JMP AGAIN
 009F	 	 	 	NEXT:
 	 	 	 	;æ¢å¤09Hä¸­æ–­	
 The Microsoft MACRO Assembler , Version 1.27          	Page	1-4
	 	 	 	 	 	 	 	05-15-<4    


 009F  FA	 	 	 	CLI
 00A0  26: 8F 06 0026	 	 	POP ES:[09H*4+2]
 00A5  26: 8F 06 0024	 	 	POP ES:[09H*4]
 00AA  FB	 	 	 	STI
 	 	 	 	;æ¢å¤1CHå‘é‡
 00AB  FA	 	 	 	CLI
 00AC  26: 8F 06 0072	 	 	POP ES:[1CH*4+2]
 00B1  26: 8F 06 0070	 	 	POP ES:[1CH*4]
 00B6  FB	 	 	 	STI
 00B7	 	 	 	EXIT:
 00B7  B4 4C	 	 	 	MOV AH,4CH
 00B9  CD 21	 	 	 	INT 21H
 	 	 	 	;;;;;;;;;;;;;;;;;;;;;å­ç¨‹åºåŒº;;;;;;;;;;;;;;
	 	 	 	;;;;;;;;;
 	 	 	 	;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”INPUTerrorå­ç¨‹åºâ€”â€”â€”â€”â€”â€”â€
	 	 	 	”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”   
 	 	 	 	;åˆ¤æ–­è¾“å…¥æ ¼å¼æ˜¯å¦åˆè§„çš„å­ç¨‹åº
 00BB	 	 	 	INPUTerror  PROC
 00BB  BB 001E R	 	 	MOV  BX, OFFSET  TIME+2 ;BXå–åˆ°æ•°ç»„
	 	 	 	çš„é¦–åœ°å€ 
 00BE  B1 00	 	 	 	MOV  CL, 00H            ;å¼€å§‹CLç½®é›¶
 	 	 	 	
 00C0  8A 07	 	 	 	MOV AL, [BX]            ;æå–BXå¯¹åº”
	 	 	 	çš„å€¼
 00C2  E8 00DB R	 	 	CALL  NUMerror          ;åˆ¤æ–­æ˜¯å¦æ˜
	 	 	 	¯æ•°å­—
 00C5  43	 	 	 	INC  BX                 ;åˆ¤æ–­ä¸‹ä¸€å­
	 	 	 	—èŠ‚
 	 	 	 	
 00C6  8A 07	 	 	    MOV AL, [BX]            ;æå–BXå¯¹åº”çš„å
	 	 	 	€¼
 00C8  E8 00DB R	 	 	CALL  NUMerror          ;åˆ¤æ–­æ˜¯å¦æ˜
	 	 	 	¯æ•°å­—
 	 	 	 	
 00CB  80 F9 00	 	 	 	CMP CL, 00H             ;CL=0è¯´æ˜Žæ ¼å
	 	 	 	¼æ­£ç¡®
 00CE  74 0A	 	 	 	JE  RIGHT               ;æ­£ç¡®åˆ™è·³è½
	 	 	 	¬
 	 	 	 	
 00D0	 	 	 	ERR0:	
 00D0  BA 0054 R	 	    MOV  DX, OFFSET  ERROR0
 00D3  B4 09	 	 	 	MOV  AH, 9
 00D5  CD 21	 	 	 	INT  21H                ;åœ¨å±å¹•æ˜¾ç¤
	 	 	 	ºERROR0	
 00D7  E9 0000 R	 	 	JMP  START              ;è·³å›žå¼€å¤´
 00DA	 	 	 	RIGHT:
 00DA  C3	 	 	 	RET
 00DB	 	 	 	INPUTerror  ENDP
 	 	 	 	;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”NUMerrorå­ç¨‹åºâ€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
 	 	 	 	;åˆ¤æ–­æ•°å­—é”™è¯¯çš„å­ç¨‹åº
 The Microsoft MACRO Assembler , Version 1.27          	Page	1-5
	 	 	 	 	 	 	 	05-15-<4    


 00DB	 	 	 	NUMerror PROC
 00DB  3C 39	 	 	 	CMP AL, 39H             ;ä¸Žâ€˜9â€™æ¯”è
	 	 	 	¾ƒ	 	 	
 00DD  77 05	 	 	 	JA  ERR_num;
 00DF  3C 30	 	 	 	CMP  AL, 30H            ;ä¸Žâ€˜0â€™æ¯”è
	 	 	 	¾ƒ	
 00E1  72 01	 	 	 	JB  ERR_num;
 00E3  C3	 	 	 	RET
 00E4	 	 	 	ERR_num:	
 00E4  B1 01	 	 	    MOV CL, 01H             ;è‹¥ä¸åœ¨æ•°å­—èŒƒ
	 	 	 	å›´ï¼ŒCLç½®1	
 00E6  C3	 	 	 	RET
 00E7	 	 	 	NUMerror ENDP
 	 	 	 	;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”ASCtoNUMå­ç¨‹åºâ€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
 	 	 	 	;ASCå˜åŽ‹ç¼©NUMçš„å­ç¨‹åº
 00E7	 	 	 	ASCtoNUM  PROC
 00E7  56	 	 	    PUSH SI;
 	 	 	 	;è½¬æ¢ä¸ªä½
 00E8  BB 001E R	 	 	MOV  BX, OFFSET  TIME+2 ;æŒ‡é’ˆæŒ‡å‘æ•
	 	 	 	°æ®åŒº
 00EB  BE 0021 R	 	    MOV  SI, OFFSET  T;
 00EE  2B C9	 	 	 	SUB  CX,CX;
 00F0  8A 4F 01	 	 	 	MOV  CL, [BX+1];
 00F3  80 E9 30	 	 	 	SUB  CL, 30H
 	 	 	 	;è½¬æ¢åä½
 00F6  8A 07	 	 	    MOV  AL,[BX];
 00F8  2C 30	 	 	    SUB  AL,30H
 	 	 	 	;æ•´åˆç›¸åŠ 
 00FA  B2 0A	 	 	    MOV  DL,10;
 00FC  F6 E2	 	 	    MUL  DL                 ;è½¬æ¢åä½
 00FE  03 C1	 	 	    ADD  AX,CX              ;æ•´åˆç›¸åŠ 
 0100  88 04	 	 	    MOV [SI],AL             ;å‚¨å­˜
 0102  2B C9	 	 	 	SUB  CX,CX;
 0104  8A 0C	 	 	    MOV  CL,[SI]            ;ä»¥ä¾¿VALUEerrorå­
	 	 	 	ç¨‹åºåˆ¤æ–­
 	 	 	 	        
 0106  5E	 	 	    POP SI;
 0107  C3	 	 	 	RET
 0108	 	 	 	ASCtoNUM ENDP
 	 	 	 	;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”VALUEerrorå­ç¨‹åºâ€”â€”â€”â€”â€”â€”â€
	 	 	 	”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â
 	 	 	 	”â€”
 E r r o r   ---	1:Extra characters on line      
 	 	 	 	;åˆ¤æ–­æ—¶é—´ç¬¦åˆå®žé™…çš„å­ç¨‹åº
 0108	 	 	 	VALUEerror  PROC
 0108  80 F9 05	 	 	 	CMP  CL, 5D             ;å’Œ5æ¯”è¾ƒ
 010B  72 08	 	 	 	JB   tooSMALL           ;<5åˆ™è·³è½¬
 010D  80 F9 32	 	 	    CMP  CL, 50D            ;å’Œ50æ¯”è¾ƒ
 0110  77 0D	 	 	 	JA   tooBIG             ;>50åˆ™è·³è½¬
 0112  EB 15 90	 	 	 	JMP  GONEXT;
 The Microsoft MACRO Assembler , Version 1.27          	Page	1-6
	 	 	 	 	 	 	 	05-15-<4    


 0115	 	 	 	tooSMALL:	
 0115  BA 006B R	 	    MOV  DX, OFFSET  ERROR1
 0118  B4 09	 	 	 	MOV  AH, 9
 011A  CD 21	 	 	 	INT  21H                ;åœ¨å±å¹•æ˜¾ç¤
	 	 	 	ºERROR1	 	 
 011C  E9 0000 R	 	 	JMP  START              ;è·³å›žå¼€å¤´
 011F	 	 	 	tooBIG:
 011F  BA 0086 R	 	    MOV  DX, OFFSET  ERROR2
 0122  B4 09	 	 	 	MOV  AH, 9
 0124  CD 21	 	 	 	INT  21H                ;åœ¨å±å¹•æ˜¾ç¤
	 	 	 	ºERROR2	 	 
 0126  E9 0000 R	 	 	JMP  START              ;è·³å›žå¼€å¤´
 0129	 	 	 	GONEXT:
 0129  C3	 	 	 	RET	
 012A	 	 	 	VALUEerror ENDP
 	 	 	 	;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”DISP1å­ç¨‹åºâ€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
 	 	 	 	€”â€”â€”
 E r r o r   ---	1:Extra characters on line      
 	 	 	 	;æ˜¾ç¤ºå¤ªé˜³çš„å­ç¨‹åº
 012A	 	 	 	DISP1 PROC FAR
 012A  56	 	 	 	PUSH SI
 012B  50	 	 	 	PUSH AX
 012C  53	 	 	 	PUSH BX
 012D  51	 	 	 	PUSH CX
 012E  52	 	 	 	PUSH DX
 	 	 	 	;BIOSä¸­æ–­è°ƒç”¨ï¼Œå±å¹•æ˜¾ç¤º
 	 	 	 	;è¯»å½“å‰æ˜¾ç¤ºçŠ¶æ€
 012F  B4 0F	 	 	 	MOV AH,15 
 0131  CD 10	 	 	 	INT 10H
 	 	 	 	;è®¾ç½®æ˜¾ç¤ºæ¨¡å¼40*25é»‘ç™½
 0133  B4 00	 	 	 	MOV AH,0
 0135  CD 10	 	 	 	INT 10H
 0137  BA 0000	 	 	 	MOV DX,0 ;è¡Œå·ä¸º0ï¼Œåˆ—å·ä¸º0
 013A	 	 	 	REPT:
 	 	 	 	;é™„åŠ ä»»åŠ¡ï¼ŒLIM2æ¬¡æ˜¾ç¤ºSUNåŽç«‹å³åœæ­¢
	 	 	 	è¿”å›žDOS
 013A  80 3E 0019 R 0C	 	 	CMP CLOCK,LIM2;ä¸ŽLIM2æ¯”è¾ƒ
 013F  72 03	 	 	 	JB 	K1
 0141  EB 31 90	 	 	 	JMP D_EXIT1
 	 	 	 	;é™„åŠ ä»»åŠ¡ï¼ŒLIM1æ¬¡é”®ç›˜åŽç«‹å³åœæ­¢è¿”
	 	 	 	å›žDOS
 0144	 	 	 	K1:	
 0144  80 3E 001A R 0C	 	 	CMP KEYN,LIM1;ä¸ŽLIM1æ¯”è¾ƒ
 0149  72 03	 	 	 	JB 	K2
 014B  EB 27 90	 	 	 	JMP D_EXIT1
 014E	 	 	 	K2:	
 	 	 	 	;è®¾ç½®å…‰æ ‡ä½ç½®
 014E  B4 02	 	 	 	MOV AH,2
 0150  CD 10	 	 	 	INT 10H
 	 	 	 	;å†™å­—ç¬¦åŠå±žæ€§åˆ°å½“å‰å…‰æ ‡ä½ç½®å¤„
 0152  B0 0F	 	 	 	MOV AL,0FH
 The Microsoft MACRO Assembler , Version 1.27          	Page	1-7
	 	 	 	 	 	 	 	05-15-<4    


 0154  B9 0001	 	 	 	MOV CX,1
 0157  B3 4F	 	 	    MOV BL,01001111B	    ;çº¢åº•ç™½å­—
 0159  B4 09	 	 	 	MOV AH,9
 015B  CD 10	 	 	 	INT 10H
 	 	 	 	;å»¶æ—¶
 015D  E8 020C R	 	 	CALL DELAY
 	 	 	 	;æ¸…é™¤å±
 0160  B0 03	 	 	 	MOV AL, 03              ;è®¾ç½®æ˜¾ç¤ºæ–
	 	 	 	¹å¼(80*25å½©è‰²æ–‡æœ¬)
 0162  B4 00	 	 	    MOV AH, 0       
 0164  CD 10	 	 	    INT 10H                 ;æ¸…å±
 0166  FE C6	 	 	    INC DH                  ;è¡Œå·+1
 0168  80 C2 02	 	 	    ADD DL, 2               ;åˆ—å·+2
 016B  2B DB	 	 	    SUB BX,BX
 	 	 	 	;æŸ¥çœ‹æ˜¯å¦åˆ°äº†æœ€å¤§è¡Œæ•°
 016D  BE 001B R	 	    MOV SI, OFFSET  LINE     
 0170  3A 34	 	 	    CMP DH, [SI]            ;ä¸ŽLINEæ¯”è¾ƒ
 0172  72 C6	 	 	    JB REPT    
 0174	 	 	 	D_EXIT1:	
 0174  5A	 	 	 	POP DX
 0175  59	 	 	 	POP CX
 0176  5B	 	 	 	POP BX
 0177  58	 	 	 	POP AX
 0178  5E	 	 	 	POP SI
 0179  CB	 	 	 	RET
 017A	 	 	 	DISP1 ENDP
 	 	 	 	;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”DISP2å­ç¨‹åºâ€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
 	 	 	 	€”â€”â€”â€”â€”â€”â€”
 E r r o r   ---	1:Extra characters on line      
 	 	 	 	;æ˜¾ç¤ºå­—ç¬¦ä¸²MSG1çš„å­ç¨‹åº
 017A	 	 	 	DISP2  PROC   FAR
 017A  56	 	 	 	PUSH SI
 017B  52	 	 	    PUSH DX
 017C  51	 	 	    PUSH CX
 017D  53	 	 	    PUSH BX
 017E  50	 	 	    PUSH AX
 	 	 	 	;è¯»å–å½“å‰å…‰æ ‡ä½ç½®
 017F  B4 03	 	 	    MOV AH, 3
 0181  B7 00	 	 	    MOV BH, 0
 0183  CD 10	 	 	    INT 10H       
 	 	 	 	
 0185  FE C2	 	 	    INC DL                  ;åˆ—å·+1
 0187  B4 02	 	 	    MOV AH, 2
 0189  CD 10	 	 	    INT 10H                 ;å°†å…‰æ ‡è®¾åœ¨ä¸‹
	 	 	 	ä¸€ä¸ªä½ç½®ï¼Œé¿å…è¦†ç›–åŽŸå­—ç¬¦
 	 	 	 	    
 018B  8D 36 0000 R	 	    LEA SI, MSG1            ;å°†å­—ç¬¦ä¸²MSG1çš
	 	 	 	„é¦–åœ°å€è£…å…¥SI
 018F  C6 04 30	 	 	    MOV BYTE PTR[SI],30H
 0192  8A 1E 0019 R	 	    MOV BL,CLOCK
 0196  80 3E 0019 R 0A	 	    CMP CLOCK,10
 The Microsoft MACRO Assembler , Version 1.27          	Page	1-8
	 	 	 	 	 	 	 	05-15-<4    


 019B  72 06	 	 	 	JB XIAOYU1
 019D	 	 	 	DAYU1:   
 019D  C6 04 31	 	 	 	MOV BYTE PTR[SI],31H
 01A0  80 EB 0A	 	 	    SUB BL,10
 01A3	 	 	 	XIAOYU1:    
 01A3  8A C3	 	 	    MOV AL,BL
 01A5  0C 30	 	 	 	OR  AL,30H
 01A7  88 44 01	 	 	 	MOV BYTE PTR[SI+1],AL    
 01AA  B9 000C	 	 	    MOV CX, SLENGTH1        ;å°†å­—ç¬¦ä¸²MSG1çš
	 	 	 	„é•¿åº¦è£…å…¥CX
 01AD	 	 	 	NEXTC1:
 01AD  B3 78	 	 	 	MOV BL,01111000B	    ;ç™½åº•é»‘å
	 	 	 	­—
 01AF  B4 09	 	 	 	MOV AH,09H
 01B1  CD 10	 	 	 	INT 10H
 	 	 	 	
 01B3  AC	 	 	    LODSB                 
 01B4  B4 0E	 	 	    MOV AH, 0EH             ;ç½®AHå¯„å­˜å™¨ä¸º0
	 	 	 	EHï¼Œè¡¨ç¤ºæ˜¾ç¤ºå­—ç¬¦å’Œå±žæ€§ã€‚ 
 01B6  BB 0001	 	 	    MOV BX, 1
 01B9  CD 10	 	 	    INT 10H
 01BB  E2 F0	 	 	    LOOP NEXTC1
 	 	 	 	;å¼¹å‡º 
 01BD  58	 	 	    POP AX
 01BE  5B	 	 	    POP BX
 01BF  59	 	 	    POP CX
 01C0  5A	 	 	    POP DX
 01C1  5E	 	 	    POP SI
 01C2  CB	 	 	 	RET
 01C3	 	 	 	DISP2    ENDP
 	 	 	 	
 	 	 	 	;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”DISP3å­ç¨‹åºâ€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
 	 	 	 	€”â€”â€”â€”â€”â€”â€”
 E r r o r   ---	1:Extra characters on line      
 	 	 	 	;é™„åŠ ä»»åŠ¡ï¼šæ˜¾ç¤ºå­—ç¬¦ä¸²MSG2çš„å­ç¨‹åº
 01C3	 	 	 	DISP3  PROC   FAR
 	 	 	 	;åŽ‹æ ˆ 
 01C3  56	 	 	    PUSH SI
 01C4  52	 	 	    PUSH DX
 01C5  51	 	 	    PUSH CX
 01C6  53	 	 	    PUSH BX
 01C7  50	 	 	    PUSH AX
 	 	 	 	;è¯»å–å½“å‰å…‰æ ‡ä½ç½®
 01C8  B4 03	 	 	    MOV AH, 3
 01CA  B7 00	 	 	    MOV BH, 0
 01CC  CD 10	 	 	    INT 10H       
 	 	 	 	
 01CE  FE C2	 	 	    INC DL              ;åˆ—å·+1
 01D0  B4 02	 	 	    MOV AH, 2
 01D2  CD 10	 	 	    INT 10H             ;å°†å…‰æ ‡è®¾åœ¨ä¸‹ä¸€ä
	 	 	 	¸ªä½ç½®ï¼Œé¿å…è¦†ç›–åŽŸå­—ç¬¦
 The Microsoft MACRO Assembler , Version 1.27          	Page	1-9
	 	 	 	 	 	 	 	05-15-<4    


 	 	 	 	    
 01D4  8D 36 000C R	 	    LEA SI, MSG2        ;å°†å­—ç¬¦ä¸²MSGçš„é¦–å
	 	 	 	œ°å€è£…å…¥SI
 01D8  C6 04 30	 	 	    MOV BYTE PTR[SI],30H
 01DB  8A 1E 001A R	 	    MOV BL,KEYN
 	 	 	 	
 	 	 	 	    ;é™„åŠ åŠŸèƒ½ï¼šåŠ å…¥æŒ‰é”®æ¬¡æ•°KEY
 01DF  80 3E 001A R 0A	 	    CMP KEYN,10
 01E4  72 06	 	 	 	JB XIAOYU2
 01E6	 	 	 	DAYU2:   
 01E6  C6 04 31	 	 	 	MOV BYTE PTR[SI],31H
 01E9  80 EB 0A	 	 	    SUB BL,10
 01EC	 	 	 	XIAOYU2:    
 01EC  8A C3	 	 	    MOV AL,BL
 01EE  0C 30	 	 	 	OR  AL,30H
 01F0  88 44 01	 	 	 	MOV BYTE PTR[SI+1],AL    
 01F3  B9 000C	 	 	    MOV CX, SLENGTH2    ;å°†å­—ç¬¦ä¸²MSG2çš„é•¿
	 	 	 	åº¦è£…å…¥CX
 01F6	 	 	 	NEXTC2:
 01F6  B3 1E	 	 	 	MOV BL,00011110B	;è“åº•é»„å­—
 01F8  B4 09	 	 	 	MOV AH,09H
 01FA  CD 10	 	 	 	INT 10H
 	 	 	 	
 01FC  AC	 	 	    LODSB               
 01FD  B4 0E	 	 	    MOV AH, 0EH         ;è®¾ç½® AH å¯„å­˜å™¨ä¸º
	 	 	 	 0EHï¼Œè¡¨ç¤ºæ˜¾ç¤ºå­—ç¬¦å’Œå±žæ€§ã€‚ 
 01FF  BB 0001	 	 	    MOV BX, 1
 0202  CD 10	 	 	    INT 10H
 0204  E2 F0	 	 	    LOOP NEXTC2
 	 	 	 	;å¼¹å‡º 
 0206  58	 	 	    POP AX
 0207  5B	 	 	    POP BX
 0208  59	 	 	    POP CX
 0209  5A	 	 	    POP DX
 020A  5E	 	 	    POP SI
 020B  CB	 	 	 	RET
 020C	 	 	 	DISP3    ENDP
 	 	 	 	
 	 	 	 	;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”DELAYå­ç¨‹åºâ€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”
 	 	 	 	€”â€”â€”â€”â€”â€”â€”
 E r r o r   ---	1:Extra characters on line      
 	 	 	 	;å»¶æ—¶1000mså­ç¨‹åº
 020C	 	 	 	DELAY	PROC	
 	 	 	 	        ;åŽ‹æ ˆ
 020C  52	 	 	 	    PUSH DX
 020D  51	 	 	 	    PUSH CX
 020E  53	 	 	        PUSH BX
 020F  50	 	 	 	    PUSH AX
 	 	 	 	        ;ä¸­æ–­è°ƒç”¨å»¶æ—¶
 0210  B4 2C	 	 	 	    MOV AH, 2CH
 0212  CD 21	 	 	 	    INT 21H	        ;DOSè°ƒç”¨ç³»ç»
 The Microsoft MACRO Assembler , Version 1.27          	Page	1-10
	 	 	 	 	 	 	 	05-15-<4    


	 	 	 	Ÿæ—¶é—´
 0214  8A DA	 	 	 	    MOV BL, DL	    ;å­˜å‚¨å½“å‰ç§’æ•°
 0216  80 C3 32	 	 	 	 	ADD BL, 50
 0219  8A FE	 	 	 	 	MOV BH, DH      ;å­˜å‚¨å½“å‰ç™
	 	 	 	¾åˆ†ç§’æ•°
 021B  80 C7 01	 	 	 	 	ADD BH, 1
 021E	 	 	 	DL_BEGIN:
 021E  CD 21	 	 	 	    INT 21H	        ;DOSè°ƒç”¨ç³»ç»
	 	 	 	Ÿæ—¶é—´
 0220  3A F7	 	 	 	 	CMP DH, BH	    ;æ¯”è¾ƒå½“å
	 	 	 	‰ç§’æ•°ä¸ŽBH
 0222  73 02	 	 	 	    JAE DL_END	    ;è‹¥å¤§äºŽBHï¼Œåˆ™å
	 	 	 	®Œæˆå»¶æ—¶ï¼Œé€€å‡ºç¨‹åº
 	 	 	 	 	    ;CMP DL, BL	    ;æ¯”è¾ƒå½“å‰ç™¾åˆ†
	 	 	 	ç§’æ•°ä¸ŽBL
 	 	 	 	 	    ;JAE DL_END	    ;è‹¥å¤§äºŽBLï¼Œåˆ™å
	 	 	 	®Œæˆå»¶æ—¶ï¼Œé€€å‡ºç¨‹åº
 0224  EB F8	 	 	 	    JMP DL_BEGIN	;åä¹‹ï¼Œåˆ™ç»
	 	 	 	§ç»­è°ƒç”¨ç³»ç»Ÿæ—¶é—´
 0226	 	 	 	DL_END:
 	 	 	 	        ;å¼¹å‡º
 0226  58	 	 	 	    POP AX
 0227  5B	 	 	        POP BX
 0228  59	 	 	 	    POP CX
 0229  5A	 	 	 	    POP DX
 022A  C3	 	 	 	    RET
 022B	 	 	 	DELAY	ENDP
 	 	 	 	;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”TIMERINTSå­ç¨‹åºâ€”â€”â€”â€”â€”â€”â€”
	 	 	 	â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€
 	 	 	 	â€”â€”â€”â€”
 E r r o r   ---	1:Extra characters on line      
 	 	 	 	;è®¾ç½®è®¡æ—¶å™¨ä¸­æ–­æœåŠ¡å­ç¨‹åº
 022B	 	 	 	TIMERINTS PROC FAR
 022B  56	 	 	 	PUSH SI
 022C  50	 	 	 	PUSH AX
 022D  FA	 	 	 	CLI
 022E  BE 0022 R	 	    MOV SI,OFFSET N
 0231  8A 04	 	 	    MOV AL,[SI]
 0233  FE 06 0018 R	 	 	INC COUNT           ;è®¡æ•°å™¨åŠ 1
 0237  38 06 0018 R	 	 	CMP COUNT,AL        ;å®šæ—¶
 023B  75 11	 	 	 	JNE GO1
 023D  C6 06 0018 R 00	 	 	MOV COUNT,0         ;æ¸…é›¶
 0242  BE 0000 R	 	 	MOV SI,OFFSET MSG1
 0245  FE 06 0019 R	 	 	INC CLOCK           ;è®¡æ•°å™¨åŠ 1
 0249  9A 017A ---- R	 	 	CALL FAR PTR DISP2	
 024E	 	 	 	GO1:
 024E  58	 	 	 	POP AX
 024F  5E	 	 	 	POP SI
 	 	 	 	 	
 0250  FB	 	 	 	STI
 0251  CF	 	 	 	IRET
 0252	 	 	 	TIMERINTS ENDP
 The Microsoft MACRO Assembler , Version 1.27          	Page	1-11
	 	 	 	 	 	 	 	05-15-<4    


 	 	 	 	;â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â
	 	 	 	€”â€”â€”KEYINTå­ç¨‹åºâ€”â€”â€”â€”â€”â€”â€”â€”
	 	 	 	â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€
 	 	 	 	â€”â€”â€”â€”â€”â€”â€”
 E r r o r   ---	1:Extra characters on line      
 	 	 	 	;è®¾ç½®é”®ç›˜ä¸­æ–­æœåŠ¡ç¨‹åº
 0252	 	 	 	KEYINT PROC FAR
 	 	 	 	;ä¿æŠ¤çŽ°åœº
 0252  56	 	 	 	PUSH SI
 0253  52	 	 	 	PUSH DX
 0254  53	 	 	 	PUSH BX
 0255  50	 	 	 	PUSH AX
 	 	 	 	;å…³ä¸­æ–­
 0256  FA	 	 	 	CLI
 	 	 	 	;è¯»å–é”®ç›˜æ‰«æç 
 0257  E4 60	 	 	 	IN AL,60H
 0259  8A E0	 	 	 	MOV AH,AL
 	 	 	 	;è¾“å‡ºä¸€ä¸ªæ­£è„‰å†²
 025B  E4 61	 	 	 	IN AL,61H
 025D  0C 80	 	 	 	OR AL,80H
 025F  E6 61	 	 	 	OUT 61H,AL
 0261  24 7F	 	 	 	AND AL,7FH
 0263  E6 61	 	 	 	OUT 61H,AL
 	 	 	 	;åˆ¤æ–­ï¼šæ— é”®æŒ‰ä¸‹åˆ™æ‰§è¡Œé€€å‡ºé”®ç›˜ä¸­æ
	 	 	 	–­
 0265  F6 C4 80	 	 	 	TEST AH,80H
 0268  75 09	 	 	 	JNE GO2
 	 	 	 	;æœ‰é”®æŒ‰ä¸‹åˆ™æ˜¾ç¤ºMSG2ï¼ŒKEYNåŒæ—¶è®¡æ•°
 026A  FE 06 001A R	 	 	INC KEYN            ;è®¡æ•°å™¨åŠ 1
 026E  9A 01C3 ---- R	 	 	CALL FAR PTR DISP3
 0273	 	 	 	GO2:
 	 	 	 	;EOIå‘½ä»¤
 0273  B0 20	 	 	 	MOV AL,20H
 0275  E6 20	 	 	 	OUT 20H,AL
 	 	 	 	
 0277  58	 	 	 	POP AX
 0278  5B	 	 	 	POP BX
 0279  5A	 	 	 	POP DX
 027A  5E	 	 	 	POP SI
 027B  FB	 	 	 	STI
 027C  CF	 	 	 	IRET
 027D	 	 	 	KEYINT ENDP
 	 	 	 	
 027D	 	 	 	CODE ENDS
 	 	 	 	END START

 The Microsoft MACRO Assembler , Version 1.27          	Page	Symbols
	 	 	 	-1
	 	 	 	 	 	 	 	05-15-<4    


Segments and groups:

	 	N a m e	 	 	Size	align	combine	class

CODE . . . . . . . . . . . . . .	027D	PARA  	NONE	
DATA . . . . . . . . . . . . . .	009F	PARA  	NONE	
STACK. . . . . . . . . . . . . .	0600	PARA  	STACK 	

Symbols:            

	 	N a m e	 	 	Type	Value	Attr         

AGAIN. . . . . . . . . . . . . .	L NEAR 	008A	CODE
ASCTONUM . . . . . . . . . . . .	N PROC	00E7	CODE	Length =0021
CLOCK. . . . . . . . . . . . . .	L BYTE 	0019	DATA
COUNT. . . . . . . . . . . . . .	L BYTE 	0018	DATA
DAYU1. . . . . . . . . . . . . .	L NEAR 	019D	CODE
DAYU2. . . . . . . . . . . . . .	L NEAR 	01E6	CODE
DELAY. . . . . . . . . . . . . .	N PROC	020C	CODE	Length =001F
DISP1. . . . . . . . . . . . . .	F PROC	012A	CODE	Length =0050
DISP2. . . . . . . . . . . . . .	F PROC	017A	CODE	Length =0049
DISP3. . . . . . . . . . . . . .	F PROC	01C3	CODE	Length =0049
DL_BEGIN . . . . . . . . . . . .	L NEAR 	021E	CODE
DL_END . . . . . . . . . . . . .	L NEAR 	0226	CODE
D_EXIT1. . . . . . . . . . . . .	L NEAR 	0174	CODE
ERR0 . . . . . . . . . . . . . .	L NEAR 	00D0	CODE
ERROR0 . . . . . . . . . . . . .	L BYTE 	0054	DATA
ERROR1 . . . . . . . . . . . . .	L BYTE 	006B	DATA
ERROR2 . . . . . . . . . . . . .	L BYTE 	0086	DATA
ERR_NUM. . . . . . . . . . . . .	L NEAR 	00E4	CODE
EXIT . . . . . . . . . . . . . .	L NEAR 	00B7	CODE
GO1. . . . . . . . . . . . . . .	L NEAR 	024E	CODE
GO2. . . . . . . . . . . . . . .	L NEAR 	0273	CODE
GONEXT . . . . . . . . . . . . .	L NEAR 	0129	CODE
INPUTERROR . . . . . . . . . . .	N PROC	00BB	CODE	Length =0020
K1 . . . . . . . . . . . . . . .	L NEAR 	0144	CODE
K2 . . . . . . . . . . . . . . .	L NEAR 	014E	CODE
KEYINT . . . . . . . . . . . . .	F PROC	0252	CODE	Length =002B
KEYN . . . . . . . . . . . . . .	L BYTE 	001A	DATA
LIM1 . . . . . . . . . . . . . .	Number	000C	
LIM2 . . . . . . . . . . . . . .	Number	000C	
LINE . . . . . . . . . . . . . .	L BYTE 	001B	DATA
MSG1 . . . . . . . . . . . . . .	L BYTE 	0000	DATA
MSG2 . . . . . . . . . . . . . .	L BYTE 	000C	DATA
N. . . . . . . . . . . . . . . .	L BYTE 	0022	DATA
NEXT . . . . . . . . . . . . . .	L NEAR 	009F	CODE
NEXTC1 . . . . . . . . . . . . .	L NEAR 	01AD	CODE
NEXTC2 . . . . . . . . . . . . .	L NEAR 	01F6	CODE
NUMERROR . . . . . . . . . . . .	N PROC	00DB	CODE	Length =000C
REPT . . . . . . . . . . . . . .	L NEAR 	013A	CODE
RIGHT. . . . . . . . . . . . . .	L NEAR 	00DA	CODE
SLENGTH1 . . . . . . . . . . . .	Number	000C	
 The Microsoft MACRO Assembler , Version 1.27          	Page	Symbols
	 	 	 	-2
	 	 	 	 	 	 	 	05-15-<4    


SLENGTH2 . . . . . . . . . . . .	Number	000C	
START. . . . . . . . . . . . . .	L NEAR 	0000	CODE
T. . . . . . . . . . . . . . . .	L BYTE 	0021	DATA
TIME . . . . . . . . . . . . . .	L BYTE 	001C	DATA
TIMERINTS. . . . . . . . . . . .	F PROC	022B	CODE	Length =0027
TOOBIG . . . . . . . . . . . . .	L NEAR 	011F	CODE
TOOSMALL . . . . . . . . . . . .	L NEAR 	0115	CODE
TXT1 . . . . . . . . . . . . . .	L BYTE 	0023	DATA
VALUEERROR . . . . . . . . . . .	N PROC	0108	CODE	Length =0022
XIAOYU1. . . . . . . . . . . . .	L NEAR 	01A3	CODE
XIAOYU2. . . . . . . . . . . . .	L NEAR 	01EC	CODE

Warning Severe
Errors	Errors 
7	0
