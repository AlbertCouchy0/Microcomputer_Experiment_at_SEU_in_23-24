 The Microsoft MACRO Assembler , Version 1.27          	Page	1-1
	 	 	 	 	 	 	 	06-01-<4    


 0000	 	 	 	DATA    SEGMENT                                
	 	 	 	     ;å®šä¹‰æ•°æ®æ®µ
 0000  0A 0D 49 43 45 20	SHOW DB  0AH,0DH, 'ICE CREAM AND TEA:$'        
	 	 	 	     ;0AH,0DHä¸ºæ¢è¡Œï¼Œå›žè½¦
       43 52 45 41 4D 20	
       41 4E 44 20 54 45	
       41 3A 24	 	 	
 0015  0294 0310 0001 0310	FREQ 	DW  660,784,1,784,880,784,660,524,1,524
	 	 	 	,588	;æŸ¥è¡¨å¯å¾—é¢‘çŽ‡,1ä¸ºä¼‘æ­¢ç¬¦
       0370 0310 0294 020C	
       0001 020C 024C	 	
 002B  0294 0001 0294 024C	        DW  660,1,660,588,524,588,1
       020C 024C 0001	 	
 0039  0294 0310 0001 0310	        DW  660,784,1,784,880,784,660,524,1,524
	 	 	 	,588
       0370 0310 0294 020C	
       0001 020C 024C	 	
 004F  0294 0001 0294 024C	        DW  660,1,660,588,1,588,524,0
       0001 024C 020C 0000	
 	 	 	 	
 005F  0032 0032 0005 004B	TIME	DW  50,50,5,75,25,50,50,50,5,25,25     
	 	 	 	     ;å¤šå°‘ä¸ª10ms
       0019 0032 0032 0032	
       0005 0019 0019	 	
 0075  0032 0005 0032 0032	        DW  50,5,50,50,50,200,5
       0032 00C8 0005	 	
 0083  0032 0032 0005 004B	        DW  50,50,5,75,25,50,50,50,5,25,25
       0019 0032 0032 0032	
       0005 0019 0019	 	
 0099  0032 0005 0032 0032	        DW  50,5,50,50,5,50,200,0
       0005 0032 00C8 0000	
 00A9	 	 	 	DATA    ENDS
 	 	 	 	
 	 	 	 	
 0000	 	 	 	STACK   SEGMENT PARA STACK 'STACK'             
	 	 	 	      ;å®šä¹‰å †æ ˆæ®µ
 0000     C8 [	 	 	        DW  200 DUP(?)
                ????	 	
                      ]	 	
 	 	 	 	
 0190	 	 	 	STACK   ENDS
 	 	 	 	
 0000	 	 	 	CODE    SEGMENT
 	 	 	 	 	ASSUME  CS:CODE, DS:DATA,SS:STACK
 	 	 	 	
 0000	 	 	 	START:
 0000  B8 ---- R	 	 	MOV AX,DATA
 0003  8E D8	 	 	 	MOV DS,AX	 	               
	 	 	 	 ;åˆå§‹åŒ–æ•°æ®æ®µ
 0005  B8 ---- R	 	 	MOV AX,STACK	 	
 0008  8E D0	 	 	 	MOV SS,AX	 	               
	 	 	 	 ;åˆå§‹åŒ–å †æ ˆæ®µ
 000A  BA 0000 R	 	 	MOV DX,OFFSET SHOW
 The Microsoft MACRO Assembler , Version 1.27          	Page	1-2
	 	 	 	 	 	 	 	06-01-<4    


 000D  B4 09	 	 	 	MOV AH,09
 000F  CD 21	 	 	 	INT 21H 	 	 	       
	 	 	 	     ;æ˜¾ç¤ºæç¤ºä¿¡æ¯
 0011  BE 0015 R	 	 	MOV SI,OFFSET FREQ	            ;å°
	 	 	 	†é¢‘çŽ‡æ•°æ®åœ°å€ç»™SI
 0014  BD 005F R	 	 	MOV BP,OFFSET TIME	            ;å°
	 	 	 	†èŠ‚æ‹æ—¶é—´æ•°æ®çš„åœ°å€ç»™BP
 0017  E8 001E R	 	 	CALL SING
 001A  B4 4C	 	 	 	MOV AH,4CH
 001C  CD 21	 	 	 	INT 21H	 	 	               
	 	 	 	 ;ç¨‹åºç»“æŸï¼Œè¿”å›žDOS
 	 	 	 	
 001E	 	 	 	SING PROC NEAR  
 001E  57	 	 	        PUSH DI
 001F  56	 	 	        PUSH SI
 0020  55	 	 	        PUSH BP
 0021  53	 	 	        PUSH BX
 0022  8B 3C	 	 	RETP:  	MOV DI,DS:[SI]	 	        ;å–é¢‘
	 	 	 	çŽ‡ç»™DI
 0024  83 FF 00	 	 	        CMP DI,0        	 	    ;0æ
	 	 	 	„å‘³ç€ç¨‹åºç»“æŸ
 0027  74 0F	 	 	        JE END_SING	 	
 0029  3E: 8B 5E 00	 	 	    MOV BX,DS:[BP]	 	       
	 	 	 	 ;å–èŠ‚æ‹ç»™BX
 002D  E8 003D R	 	        CALL SOUND         	 	    ;å
	 	 	 	‚æ•°ä¸ºDIå’ŒBX
 0030  83 C6 02	 	 	        ADD SI,2
 0033  83 C5 02	 	 	        ADD BP,2
 0036  EB EA	 	 	        JMP RETP
 0038	 	 	 	END_SING:
 0038  5B	 	 	 	 	POP  BX
 0039  5D	 	 	        POP  BP
 003A  5E	 	 	      	POP  SI
 003B  5F	 	 	        POP  DI
 003C  C3	 	 	        RET
 003D	 	 	 	SING ENDP
 	 	 	 	
 003D	 	 	 	SOUND PROC  NEAR
 003D  50	 	 	        PUSH AX
 003E  53	 	 	       	PUSH BX          	 	    ;BX
	 	 	 	èŠ‚æ‹æ—¶é—´æ•°æ®
 003F  51	 	 	        PUSH CX
 0040  52	 	 	       	PUSH DX
 0041  57	 	 	        PUSH DI           	 	    ;DI
	 	 	 	ç»™å®šé¢‘çŽ‡æ•°æ®
 0042  B0 B6	 	 	        MOV AL,10110110B     	    ;8253åˆå§‹
	 	 	 	åŒ–(é€šé“2ï¼Œæ–¹å¼3ï¼Œäº§ç”Ÿæ–¹æ³¢ä¿¡å·)
 0044  E6 43	 	 	        OUT 43H,AL      	 	    ;43
	 	 	 	Hç«¯å£æ˜¯8253çš„å‘½ä»¤å¯„å­˜å™¨
 	 	 	 	
 0046  83 FF 01	 	 	 	    CMP DI,1                    ;åˆ¤æ–­
	 	 	 	æ˜¯å¦ä¸ºä¼‘æ­¢ç¬¦
 0049  74 16	 	 	 	    JE DELAY
 The Microsoft MACRO Assembler , Version 1.27          	Page	1-3
	 	 	 	 	 	 	 	06-01-<4    


 	 	 	 	
 004B  BA 0012	 	 	        MOV DX,12H      	 	    ;è®
	 	 	 	¡ç®—æŠ˜ç®—é¢‘çŽ‡ï¼ˆæ—¶é—´å¸¸æ•°ï¼‰
 004E  B8 34DC	 	 	        MOV AX,34DCH                ;1234CDHé™¤
	 	 	 	ä»¥ç»™å®šé¢‘çŽ‡
 0051  F7 F7	 	 	        DIV DI
 	 	 	 	
 0053  E6 42	 	 	        OUT 42H,AL      	 	    ;ç»
	 	 	 	™8253é€šé“2è®¾ç½®è®¡æ•°åˆå€¼ï¼ˆå…ˆå†™ä½Žå­—èŠ
	 	 	 	‚ï¼Œå†å†™é«˜å­—èŠ‚ï¼‰
 0055  8A C4	 	 	        MOV AL,AH
 0057  E6 42	 	 	        OUT 42H,AL
 	 	 	 	
 0059  E4 61	 	 	        IN  AL,61H  	 	        ;è¯»825
	 	 	 	5Bå£
 005B  8A E0	 	 	        MOV AH,AL
 005D  0C 03	 	 	        OR  AL,3       	 	        ;8255â€
	 	 	 	”â€”PB1PB0ç½®1ï¼Œå¼€å–‡å­
 005F  E6 61	 	 	        OUT 61H,AL
 0061	 	 	 	DELAY:
 0061  E8 0071 R	 	  	CALL DELAYS  
 0064  4B	 	 	 	DEC BX	 	 	        ;BXâ€”è
	 	 	 	Š‚æ‹æ—¶é—´å¯¹åº”10msçš„å€æ•°ï¼Œå¦‚:BX=100,èŠ‚
	 	 	 	æ‹æ—¶é—´=10ms*100=1s
 0065  75 FA	 	 	    JNZ  DELAY
 0067  8A C4	 	 	    MOV   AL,AH
 0069  E6 61	 	 	    OUT   61H,AL       	 	        ;8255â€
	 	 	 	”â€”PB1PB0æ¢å¤ä¸ºé›¶ï¼Œå…³å–‡å­
 006B  5F	 	 	    POP DI
 006C  5A	 	 	    POP DX
 006D  59	 	 	    POP CX
 006E  5B	 	 	    POP BX
 006F  58	 	 	    POP AX
 0070  C3	 	 	    RET
 0071	 	 	 	SOUND   ENDP
 	 	 	 	
 0071	 	 	 	DELAYS	PROC	NEAR
 	 	 	 	        ;åŽ‹æ ˆ
 0071  52	 	 	 	    PUSH DX
 0072  51	 	 	 	    PUSH CX
 0073  53	 	 	            PUSH BX
 0074  50	 	 	 	    PUSH AX
 	 	 	 	        ;ä¸­æ–­è°ƒç”¨å»¶æ—¶
 0075  B4 2C	 	 	 	    MOV AH, 2CH
 0077  CD 21	 	 	 	    INT 21H	;DOSè°ƒç”¨ç³»ç»Ÿæ—¶é—´
 0079  8A DA	 	 	 	    MOV BL, DL	;å­˜å‚¨å½“å‰1/100ç§’æ•
	 	 	 	°
 007B  8A FE	 	 	            MOV BH, DH
 007D  FE C7	 	 	            INC BH
 007F  FE C3	 	 	            INC BL
 0081	 	 	 	DELAY_BEGIN:
 0081  B4 2C	 	 	            MOV AH, 2CH
 0083  CD 21	 	 	 	    INT 21H	;è°ƒç”¨ç³»ç»Ÿæ—¶é—´
 The Microsoft MACRO Assembler , Version 1.27          	Page	1-4
	 	 	 	 	 	 	 	06-01-<4    


 0085  3A FE	 	 	 	    CMP BH, DH	;æ¯”è¾ƒå½“å‰æ—¶é—´ä¸Žä
	 	 	 	¸Šæ¬¡è°ƒç”¨çš„ç§’æ˜¯å¦å˜åŒ–
 0087  75 06	 	 	 	    JNE DELAY_NEXT	;è‹¥æœ‰å˜åŒ–ï¼
	 	 	 	Œåˆ™å®Œæˆå»¶æ—¶ï¼Œé€€å‡ºç¨‹åº
 0089  3A DA	 	 	            CMP BL, DL	;æ¯”è¾ƒå½“å‰æ—¶é—´ä¸Žä
	 	 	 	¸Šæ¬¡è°ƒç”¨çš„ç™¾åˆ†ç§’æ˜¯å¦å˜åŒ–
 008B  73 02	 	 	 	    JAE DELAY_NEXT	;è‹¥ï¼Œåˆ™å®Œæˆ
	 	 	 	å»¶æ—¶ï¼Œé€€å‡ºç¨‹åº
 008D  EB F2	 	 	 	    JMP DELAY_BEGIN	;è‹¥æ— å˜åŒ–ï¼
	 	 	 	Œåˆ™ç»§ç»­è°ƒç”¨ç³»ç»Ÿæ—¶é—´
 008F	 	 	 	DELAY_NEXT:
 	 	 	 	        ;å¼¹å‡º
 008F  58	 	 	 	    POP AX
 0090  5B	 	 	            POP BX
 0091  59	 	 	 	    POP CX
 0092  5A	 	 	 	    POP DX
 0093  C3	 	 	 	    RET
 0094	 	 	 	DELAYS	ENDP
 	 	 	 	
 0094	 	 	 	CODE ENDS
 	 	 	 	END START 

 The Microsoft MACRO Assembler , Version 1.27          	Page	Symbols
	 	 	 	-1
	 	 	 	 	 	 	 	06-01-<4    


Segments and groups:

	 	N a m e	 	 	Size	align	combine	class

CODE . . . . . . . . . . . . . .	0094	PARA  	NONE	
DATA . . . . . . . . . . . . . .	00A9	PARA  	NONE	
STACK. . . . . . . . . . . . . .	0190	PARA  	STACK 	'STACK'

Symbols:            

	 	N a m e	 	 	Type	Value	Attr         

DELAY. . . . . . . . . . . . . .	L NEAR 	0061	CODE
DELAYS . . . . . . . . . . . . .	N PROC	0071	CODE	Length =0023
DELAY_BEGIN. . . . . . . . . . .	L NEAR 	0081	CODE
DELAY_NEXT . . . . . . . . . . .	L NEAR 	008F	CODE
END_SING . . . . . . . . . . . .	L NEAR 	0038	CODE
FREQ . . . . . . . . . . . . . .	L WORD 	0015	DATA
RETP . . . . . . . . . . . . . .	L NEAR 	0022	CODE
SHOW . . . . . . . . . . . . . .	L BYTE 	0000	DATA
SING . . . . . . . . . . . . . .	N PROC	001E	CODE	Length =001F
SOUND. . . . . . . . . . . . . .	N PROC	003D	CODE	Length =0034
START. . . . . . . . . . . . . .	L NEAR 	0000	CODE
TIME . . . . . . . . . . . . . .	L WORD 	005F	DATA

Warning Severe
Errors	Errors 
0	0
